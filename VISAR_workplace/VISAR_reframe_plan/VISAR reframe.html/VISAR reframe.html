<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.0.2 (457850)"/><meta name="altitude" content="19.66666793823242"/><meta name="author" content="qid325@gmail.com"/><meta name="created" content="2020-02-12 12:55:42 +0000"/><meta name="latitude" content="31.87472900975176"/><meta name="longitude" content="117.2596671332344"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2020-02-12 13:47:46 +0000"/><title>VISAR reframe</title></head><body><ul><li><div><font style="font-size: 18px;"><b>各model class的层级关系</b></font></div></li><ul><li><div>最上层：VISAR_model</div></li><ul><li><div>所有参数在para_dict中，其中包括：</div></li><ul><li><div>Model name</div></li><li><div>Model type: &lt;platform&gt;_&lt;type&gt;_&lt;reg/class&gt;</div></li><li><div>Model specific parameters: 例如隐层的节点数等</div></li><li><div>Training related parameters: 例如epoch, learning rate等</div></li><li><div>GPU: True/False</div></li><li><div>Fingerprint type</div></li><li><div>Data process related parameters: 例如是否做normalization、clip的参数等；变换相关参数需要保存</div></li></ul><li><div>methods包括：</div></li><ul><li><div>model_init</div></li><li><div>predict</div></li><li><div>evaluation</div></li><li><div>fit</div></li><li><div>save_model</div></li><li><div>load_model</div></li><li><div>save_parameter (as json file)</div></li><li><div>load_parameter</div></li><li><div><span style=""><font style="color: rgb(255, 38, 0);">generate_viz_results （可能是最有特色的部分，细的过程拆分成function，伴随特定平台和模型结构写接口）</font></span></div></li></ul></ul></ul><ul><li><div>platform层：继承VISAR_model的class，model_init、save、load等method对应平台替换为特定的function</div></li><ul><li><div><span>Sklearn</span></div></li><li><div>Pytorch</div></li><li><div>Deepchem</div></li><li><div>Tensorflow</div></li></ul><li><div>Regressor / Classifier层：继承platform层的class，fit、evalution等method替换为回归或分类特定的function</div></li><li><div>Specific model层：继承Regressor / Classifier层的class，对model_init、generate_viz_results里的相应function做替换</div></li></ul></ul><div><br/></div><ul><li><div><span><b><font style="font-size: 18px;">关于DataLoader:</font></b></span></div></li><ul><li><div>Pytorch需要自己写一个dataloader（哭出声）</div></li><li><div>Deepchem和Tensorflow可以调用Deepchem的DataLoader</div></li><li><div>由于Sklearn主要是baseline模型，会与Pytorch或Deepchem同时使用，调用相应平台的loader就好</div></li></ul></ul><div><br/></div><ul><li><div><font style="font-size: 18px;"><b>关于项目代码管理：</b></font></div></li><ul><li><div>data (各种预处理过的数据集)</div></li><li><div>data_loaders</div></li><ul><li><div>pytorch_loader</div></li></ul></ul><ul><li><div>model_libs</div></li><ul><li><div>visar_model.py</div></li><li><div>sklearn</div></li><ul><li><div>baseline_model.py (father class of this folder)</div></li><li><div>baseline_utils</div></li><li><div>SVR_reg.py</div></li><li><div>Ridge_reg.py</div></li><li><div>...</div></li></ul><li><div>pytorch</div></li><ul><li><div>pytorch_model.py (father class of this folder)</div></li><li><div>pytorch_utils</div></li><li><div>Attentive_FP_reg.py</div></li><li><div>Attentive_FP_class.py</div></li><li><div>DNN_reg.py</div></li><li><div>DNN_class.py</div></li><li><div>RNN_reg.py</div></li><li><div>RNN_class.py</div></li><li><div>...</div></li></ul><li><div>deepchem</div></li><ul><li><div>dc_model.py (father class of this folder)</div></li><li><div>dc_utils</div></li><li><div>RobustMT_reg.py</div></li><li><div>RobustMT_class.py</div></li><li><div>ST_reg.py</div></li><li><div>ST_class.py</div></li><li><div>...</div></li></ul><li><div>tensorflow</div></li><ul><li><div>...</div></li></ul></ul><li><div>VISAR_webapp (可视化界面相关的代码，是单独的）</div></li><li><div>Validation (可视化验证数据集）</div></li><ul><li><div>KLIFS (激酶的验证数据集)</div></li><li><div>...</div></li></ul><li><div>Projects (实际使用时所在的工作环境)</div></li><ul><li><div>tutorial</div></li><ul><li><div>Main.py （执行全流程的主文件）</div></li><li><div>logs （这个文件夹用以储存训练过程中的模型和log）</div></li></ul></ul></ul><ul><ul><ul><li><div>Training_model_parameters.json （para_dict）</div></li><li><div>Viz_results （这个文件夹用于储存用于可视化的文件）</div></li><li><div>其他输出结果</div></li></ul><li><div>Kinase</div></li><li><div>ICD</div></li><li><div>CNH</div></li><li><div>...</div></li></ul></ul></ul><div><br/></div><ul><li><div><font style="font-size: 18px;"><b>说明</b></font></div></li><ul><li><div><font style="font-size: 14px;">在这个框架下有希望实现：用户只提供自己训练好的模型，可以接上做可视化；</font></div></li><ul><li><div>需要用户指定在哪个平台上训练的模型，以及必要的模型参数；</div></li><li><div>视情况可直接使用我们已经写好的model class，此时就只需要修改para_dict的设定，然后load_model就可以了；</div></li><li><div>或者inherit更高级别的platform class，自定义一下模型结构；</div></li><li><div>之后就可以在visar_model object的支持下调用<span style="color: #ff2600;">generate_viz_results</span>，理论上就可以生成可视化需要的文件，并使用webapp分析了</div></li></ul><li><div>工作计划：</div></li><ul><li><div>先单独写deepchem的这一支，迁移ST, MT和RobustMT到这个框架下（预计到16号，然后就可以先跑kinase模型了）</div></li><li><div>Sklearn的这一支，和deepchem同步进行</div></li><li><div>写pytorch dataloader（预计到16日）</div></li><li><div>迁移Attentive_FP到这个框架下 + 调试DNN （预计到20日）</div></li><li><div>统一修正和完善整体</div></li><li><div>然后是很难的一些（预计到29日）：</div></li><ul><li><div>Dim reduction：PCA, tSNE, UMAP多模式支持</div></li><li><div>derivative/gradient/sensitivity calculation：SHAP支持，更多比较方法可以用...</div></li></ul><li><div>关于KLIFS的验证：</div></li><ul><li><div>需要gradient文件到化合物的mapping接口(在VISAR_webapp里)；</div></li><li><div>打分规则如何设计？？</div></li></ul></ul><li><div>工作原则：</div></li><ul><li><div>先尽量在本地写好代码的主体内容（一定要细心！）</div></li><li><div>想好输入输出和各个部分，在集群上一块一块地调试（一定要细心！X2）</div></li></ul></ul></ul><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>